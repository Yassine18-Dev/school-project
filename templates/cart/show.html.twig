{% extends 'front/base_front.html.twig' %}

{% block title %}Mon Panier{% endblock %}

{% block body %}
<div class="cart-page">
    <h1>ðŸ›’ Mon Panier</h1>

    {% if cart is empty %}
        <p style="text-align:center;color:#9ca3af;">Votre panier est vide.</p>
    {% else %}
        <table>
            <thead>
                <tr>
                    <th>Produit</th>
                    <th>QuantitÃ©</th>
                    <th>Prix</th>
                </tr>
            </thead>
            <tbody>
                {% for product in products %}
                    <tr>
                        <td>{{ product.name }}</td>
                        <td>{{ cart[product.id] }}</td>
                        <td>{{ (product.price * cart[product.id])|number_format(2) }} â‚¬</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="cart-total">
            Total : {{ products|reduce((carry, p) => carry + (p.price * cart[p.id]), 0)|number_format(2) }} â‚¬
        </div>

        <!-- Bouton ouvrir modal -->
        <button id="open-payment-modal">ðŸ’³ Passer commande</button>

        <!-- Token CSRF pour le POST Symfony -->
        <input type="hidden" id="csrf_token" value="{{ csrf_token('cart_checkout') }}">
    {% endif %}
</div>

<!-- Modal Paiement -->
<div id="payment-modal" class="payment-modal" style="display:none;">
    <div class="payment-box">
        <h2>ðŸ’³ Paiement sÃ©curisÃ©</h2>
        <p class="payment-sub">Simulation de paiement </p>

        <label>Nom sur la carte</label>
        <input type="text" placeholder="MOATEZ BEN SALEM">

        <label>NumÃ©ro de carte</label>
        <input type="text" placeholder="4242 4242 4242 4242">

        <div class="payment-row">
            <div>
                <label>Expiration</label>
                <input type="text" placeholder="MM/AA">
            </div>
            <div>
                <label>CVC</label>
                <input type="text" placeholder="123">
            </div>
        </div>

        <button id="pay-btn">Payer</button>
        <button class="close-btn" id="close-payment">Annuler</button>
    </div>
</div>
{% endblock %}

{% block javascripts %}
  {{ parent() }}

{% endblock %}
